<!-- Attachment Upload Component -->
<!-- Create as: ~/edgecase/web/templates/components/attachment_upload.html -->

<div class="attachments-section">
    <h4>Attachments</h4>
    
    <!-- Existing attachments list -->
    {% if attachments %}
    <div class="attachment-list">
        {% for attachment in attachments %}
        <div class="attachment-item">
            <span class="attachment-item-content">
                <i data-lucide="paperclip" class="attachment-icon"></i>
                <div>
                    <strong class="attachment-filename">{{ attachment.filename }}</strong>
                    {% if attachment.description != attachment.filename %}
                    <div class="attachment-desc">{{ attachment.description }}</div>
                    {% endif %}
                    <span class="attachment-meta">
                        {{ "%.1f"|format(attachment.filesize / 1024) }} KB
                        â€¢ Uploaded {{ attachment.uploaded_at|timestamp_to_date }}
                    </span>
                </div>
            </span>
            <div class="attachment-actions">
                <a href="{{ url_for('entries.download_attachment', attachment_id=attachment.id) }}" 
                   class="btn-small">
                    Download
                </a>
                {% if allow_delete %}
                <form method="POST" action="{{ url_for('entries.delete_attachment', attachment_id=attachment.id) }}" 
                      onsubmit="return confirm('Delete this attachment?');">
                    <button type="submit" class="btn-small btn-danger">Delete</button>
                </form>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p class="empty-attachments">No attachments yet.</p>
    {% endif %}
    
    <!-- Upload form (only if allowed) -->
    {% if allow_upload %}
    <form method="POST" 
          action="{{ url_for('upload_attachment', entry_id=entry.id) }}" 
          enctype="multipart/form-data" 
          class="upload-form-dashed">
        <div class="upload-form-grid">
            <div class="file-field">
                <label for="file">Choose file</label>
                <input type="file" 
                       id="file" 
                       name="file" 
                       required>
            </div>
            <div class="desc-field">
                <label for="description">Description (optional)</label>
                <input type="text" 
                       id="description" 
                       name="description" 
                       placeholder="Brief description of the file">
            </div>
            <button type="submit" class="btn btn-upload">Upload</button>
        </div>
    </form>
    {% endif %}
</div>
